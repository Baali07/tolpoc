<!DOCTYPE html>
<html>
<head><meta charset="utf-8"><title>RPC test</title></head>
<body>
<h3>RPC PoC inside iframe</h3>
<pre id="log"></pre>
<script>
const log = m => { console.log(m); document.getElementById('log').textContent += m + '\n'; };

log('iframe origin: ' + location.origin);
log('parent comparison: ' + (window === window.parent));   // يجب أن يكون false

const id = crypto.randomUUID();
window.addEventListener('message', e => log('[recv] ' + JSON.stringify(e.data)));

window.parent.postMessage({
  type: 'rpc',
  id,
  name: 'fetch',
  payload: { url: '/editor', requestInit: { method: 'GET' } }
}, '*');

log('[sent] id=' + id);
</script>
</body>
</html>
